(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{270:function(t,a,s){"use strict";s.r(a);var n=s(38),e=Object(n.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"vue原理剖析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue原理剖析","aria-hidden":"true"}},[t._v("#")]),t._v(" Vue原理剖析")]),t._v(" "),s("h2",{attrs:{id:"源码目录剖析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#源码目录剖析","aria-hidden":"true"}},[t._v("#")]),t._v(" 源码目录剖析")]),t._v(" "),s("ul",[s("li",[t._v("comipler 模板解析的相关文件")]),t._v(" "),s("li",[t._v("core 核心代码")]),t._v(" "),s("li",[t._v("platforms 对应的两个平台")]),t._v(" "),s("li",[t._v("server服务端渲染相关")]),t._v(" "),s("li",[t._v("sfc 解析vue文件变成一个对象")]),t._v(" "),s("li",[t._v("shared 定义的工具方法")])]),t._v(" "),s("h2",{attrs:{id:"从入口文件剖析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从入口文件剖析","aria-hidden":"true"}},[t._v("#")]),t._v(" 从入口文件剖析")]),t._v(" "),s("h4",{attrs:{id:"引入代码时会优先采用module-如果找不到则会加载main对应文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#引入代码时会优先采用module-如果找不到则会加载main对应文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 引入代码时会优先采用module 如果找不到则会加载main对应文件")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("package.json")]),t._v(" "),s("ul",[s("li",[t._v('"main": "dist/vue.runtime.common.js"')]),t._v(" "),s("li",[t._v('"module": "dist/vue.runtime.esm.js"')])])]),t._v(" "),s("li",[s("p",[t._v("查看npm run build的结果")]),t._v(" "),s("ul",[s("li",[t._v('"build": "node scripts/build.js"')])])]),t._v(" "),s("li",[s("p",[t._v("查看build.js,build中会基于config文件来实现打包")]),t._v(" "),s("ul",[s("li",[t._v("'web-runtime-cjs-dev' 只包含runtime")]),t._v(" "),s("li",[t._v("'web-runtime-cjs-prod'")]),t._v(" "),s("li",[t._v("'web-full-cjs-dev' 包含runtime+compiler")]),t._v(" "),s("li",[t._v("'web-full-cjs-prod'")]),t._v(" "),s("li",[t._v("'web-runtime-esm' 只包含runtime (es6 module)")]),t._v(" "),s("li",[t._v("'web-full-esm' 包含runtime+compiler(es6 module)")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("找到打包前的文件 web/entry-runtime-with-compiler")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("entry-runtime-with-compiler")]),t._v(" "),s("ul",[s("li",[t._v("找到对应platforms下的web下的entry-runtime-with-compiler文件")]),t._v(" "),s("li",[t._v("'./runtime/index' Vue在runtime/index中定义")])])]),t._v(" "),s("li",[s("p",[t._v("./runtime/index")]),t._v(" "),s("ul",[s("li",[t._v("引入了 'core/index'中的Vue")])])]),t._v(" "),s("li",[s("p",[t._v("core/index")]),t._v(" "),s("ul",[s("li",[t._v("'./instance/index' 引入了Vue")]),t._v(" "),s("li",[t._v("initGlobalAPI() 初始化全局API")])])]),t._v(" "),s("li",[s("p",[t._v("instance/index")])])]),t._v(" "),s("blockquote",[s("p",[t._v("最终我们找到了Vue的构造函数")])]),t._v(" "),s("h2",{attrs:{id:"entry-runtime-with-compiler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#entry-runtime-with-compiler","aria-hidden":"true"}},[t._v("#")]),t._v(" entry-runtime-with-compiler")]),t._v(" "),s("h4",{attrs:{id:"在此文件中包装了-mount方法，如果有template会将template转化成render函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在此文件中包装了-mount方法，如果有template会将template转化成render函数","aria-hidden":"true"}},[t._v("#")]),t._v(" 在此文件中包装了$mount方法，如果有template会将template转化成render函数")]),t._v(" "),s("ul",[s("li",[t._v("compileToFunctions\n"),s("ul",[s("li",[t._v("词法分析")]),t._v(" "),s("li",[t._v("语法分析")]),t._v(" "),s("li",[t._v("生成代码")]),t._v(" "),s("li",[t._v("new Function，转化成render函数Í")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("如果有render会先调用render，没有render会找模板是不是 #号方式引入.如果不是就找外部模板")])]),t._v(" "),s("h2",{attrs:{id:"runtime-index-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#runtime-index-js","aria-hidden":"true"}},[t._v("#")]),t._v(" runtime/index.js")]),t._v(" "),s("ul",[s("li",[t._v("Vue.prototype.patch 提供了__patach__方法")]),t._v(" "),s("li",[t._v("$mount方法通用的$mount方法，会调用挂载组件的方法")])]),t._v(" "),s("h2",{attrs:{id:"core-index-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#core-index-js","aria-hidden":"true"}},[t._v("#")]),t._v(" core/index.js")]),t._v(" "),s("ul",[s("li",[t._v("initGlobalApi 初始化全局api方法")])]),t._v(" "),s("h2",{attrs:{id:"initglobalapi"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initglobalapi","aria-hidden":"true"}},[t._v("#")]),t._v(" initGlobalAPI")]),t._v(" "),s("ul",[s("li",[t._v("Vue.util 初始化vue的工具方法")]),t._v(" "),s("li",[t._v("Vue.set 响应式变化的方法")]),t._v(" "),s("li",[t._v("Vue.delete")]),t._v(" "),s("li",[t._v("Vue.nextTick")]),t._v(" "),s("li",[t._v("Vue.component")]),t._v(" "),s("li",[t._v("Vue.directive")]),t._v(" "),s("li",[t._v("Vue.filter")])]),t._v(" "),s("blockquote",[s("p",[t._v("增加了keep-alive组件")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nextTick "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 浏览器事件环")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initUse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化Vue.use 默认会调用当前插件的install方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initMixin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//初始化Vue.mixin   混合 将传入的属性混合到this.options中")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initExtend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化Vue.extend 会创建个子类 继承于父类")]),t._v("\n")])])]),s("h2",{attrs:{id:"分析入口做了哪些事？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析入口做了哪些事？","aria-hidden":"true"}},[t._v("#")]),t._v(" 分析入口做了哪些事？")]),t._v(" "),s("h4",{attrs:{id:"instance-index-vue的构造函数中默认会调用this-init方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#instance-index-vue的构造函数中默认会调用this-init方法","aria-hidden":"true"}},[t._v("#")]),t._v(" instance/index vue的构造函数中默认会调用this._init方法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化vue生命周期流程以及响应式流程启动")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initMixin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// _init")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始实例属性和方法 $set\\$delete\\$watch 挂载与实例相关的方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stateMixin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue实例中事件相关的方法 $on\\$once\\$once\\$off\\$emit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("eventsMixin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生命周期相关方法  $forceUpdate $destroy")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lifecycleMixin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 渲染函数 提供_render方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderMixin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("生命周期图")])]),t._v(" "),s("h2",{attrs:{id:"initmixin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initmixin","aria-hidden":"true"}},[t._v("#")]),t._v(" initMixin")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initLifecycle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化家族关系")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initEvents")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给实例增加events属性")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initRender")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在实例上增加createElement方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'beforeCreate'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用beforeCreated方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initInjections")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化inject方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化 props,method,data,watch")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initProvide")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化话provide方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'created'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用created生命周期")]),t._v("\nvm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("$mount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 挂载元素")]),t._v("\n")])])]),s("h2",{attrs:{id:"initstate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initstate","aria-hidden":"true"}},[t._v("#")]),t._v(" initState")]),t._v(" "),s("h4",{attrs:{id:"初始化实例上的内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化实例上的内容","aria-hidden":"true"}},[t._v("#")]),t._v(" 初始化实例上的内容")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initProps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化属性")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initMethods")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("methods"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initComputed")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("computed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化计算属性")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("initWatch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("watch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化watch")]),t._v("\n")])])]),s("h2",{attrs:{id:"iniprops"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#iniprops","aria-hidden":"true"}},[t._v("#")]),t._v(" iniProps")]),t._v(" "),s("ul",[s("li",[t._v("将所有的属性放到_props上")]),t._v(" "),s("li",[t._v("通过vm代理_props上的属性")]),t._v(" "),s("li",[t._v("如果是跟节点将属性变成响应式的属性")])]),t._v(" "),s("h2",{attrs:{id:"initmethods"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initmethods","aria-hidden":"true"}},[t._v("#")]),t._v(" initMethods")]),t._v(" "),s("ul",[s("li",[t._v("实例上增加对应的方法")])]),t._v(" "),s("h2",{attrs:{id:"initdata"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initdata","aria-hidden":"true"}},[t._v("#")]),t._v(" initData")]),t._v(" "),s("h4",{attrs:{id:"响应式原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#响应式原理","aria-hidden":"true"}},[t._v("#")]),t._v(" 响应式原理")]),t._v(" "),s("ul",[s("li",[t._v("observe(data, true /* asRootData */)")]),t._v(" "),s("li",[t._v("this.walk(value) // 循环遍历")]),t._v(" "),s("li",[t._v("defineReactive(obj, keys[i]); // 定义响应式数据变化")]),t._v(" "),s("li",[t._v("get方法中dep.depend()依赖收集")]),t._v(" "),s("li",[t._v("set方法中dep.notify()通知更新")])]),t._v(" "),s("h2",{attrs:{id:"initcomputed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initcomputed","aria-hidden":"true"}},[t._v("#")]),t._v(" initComputed")]),t._v(" "),s("ul",[s("li",[t._v("通过watcher实现计算属性")]),t._v(" "),s("li",[t._v("如果watcher是脏的就获取最新结果")])]),t._v(" "),s("h2",{attrs:{id:"initwatch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initwatch","aria-hidden":"true"}},[t._v("#")]),t._v(" initWatch")]),t._v(" "),s("ul",[s("li",[t._v("借用Watcher绑定$watch,初始化$watch方法")])]),t._v(" "),s("h2",{attrs:{id:"mount"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mount","aria-hidden":"true"}},[t._v("#")]),t._v(" $mount")]),t._v(" "),s("h4",{attrs:{id:"将模板编译成函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将模板编译成函数","aria-hidden":"true"}},[t._v("#")]),t._v(" 将模板编译成函数")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("compileToFunctions")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("template"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    outputSourceRange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'production'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    shouldDecodeNewlines"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    shouldDecodeNewlinesForHref"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    delimiters"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("delimiters"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    comments"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("comments\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将解析出来的方法放到this上，调用上层mount方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mountComponent();")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("updateComponent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 增加更新组件方法")]),t._v("\n    vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_update")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hydrating"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听数据变化 执行beforeUpdate方法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" updateComponent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" noop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("before")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_isMounted "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_isDestroyed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'beforeUpdate'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* isRenderWatcher */")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("callHook")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mounted'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 组件挂载完成")]),t._v("\n")])])]),s("h2",{attrs:{id:"lifecyclemixin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lifecyclemixin","aria-hidden":"true"}},[t._v("#")]),t._v(" lifecycleMixin")]),t._v(" "),s("h4",{attrs:{id:"调用-update方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#调用-update方法","aria-hidden":"true"}},[t._v("#")]),t._v(" 调用_update方法")]),t._v(" "),s("ul",[s("li",[t._v("Vue.prototype._update\n"),s("ul",[s("li",[t._v("vm.patch() 渲染出真实的dom元素")])])])]),t._v(" "),s("h2",{attrs:{id:"patch-方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#patch-方法","aria-hidden":"true"}},[t._v("#")]),t._v(" __patch__方法")]),t._v(" "),s("h4",{attrs:{id:"dom-diff原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom-diff原理","aria-hidden":"true"}},[t._v("#")]),t._v(" dom-diff原理")]),t._v(" "),s("ul",[s("li",[t._v("createPatchFunction")])]),t._v(" "),s("h2",{attrs:{id:"rendermixin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rendermixin","aria-hidden":"true"}},[t._v("#")]),t._v(" renderMixin")]),t._v(" "),s("ul",[s("li",[t._v("Vue.prototype._render 获取虚拟dom元素")]),t._v(" "),s("li",[t._v("vm._update会更新页面\n"),s("img",{attrs:{src:"/lifecycle.jpeg",alt:"生命周期"}}),t._v(" "),s("img",{attrs:{src:"/diff.jpg",alt:"diff"}})])])])},[],!1,null,null,null);a.default=e.exports}}]);